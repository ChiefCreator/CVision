generator client {
  provider = "prisma-client-js"
  output   = "generated/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  email    String  @unique
  password String
  name     String?

  resumes Resume[]
}

model Resume {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  title               String?
  personalDetails     PersonalDetails?
  professionalSummary ProfessionalSummary?
  employmentHistory   EmploymentHistory?
  education           Education?
  links               Links?
  skills              Skills?
  languages           Languages?
  courses             Courses?
  customSections      CustomSections[]

  userId String @map("user_id")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model PersonalDetails {
  id           String  @id @default(uuid())
  title        String?
  defaultTitle String?

  avatarUrl      String?   @map("avatar_url")
  jobTitle       String?   @map("job_title")
  fullName       String?   @map("full_name")
  email          String?
  phone          String?
  address        String?
  city           String?
  country        String?
  postalCode     String?   @map("postal_code")
  drivingLicense String?   @map("driving_license")
  birthPlace     String?   @map("birth_place")
  birthDate      String? @map("birth_date")
  nationality    String?

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model ProfessionalSummary {
  id           String  @id @default(uuid())
  title        String?
  defaultTitle String?

  summary String?

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}

model EmploymentHistory {
  id           String              @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         EmploymentHistorySubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model EmploymentHistorySubsection {
  id String @id @default(uuid())

  jobTitle    String?   @map("job_title")
  employer    String?
  startDate   String? @map("start_date")
  endDate     String? @map("end_date")
  city        String?
  description String?

  sectionId String @map("section_id")

  section EmploymentHistory @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Education {
  id           String      @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         EducationSubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model EducationSubsection {
  id String @id @default(uuid())

  school      String?
  degree      String?
  startDate   String? @map("start_date")
  endDate     String? @map("end_date")
  city        String?
  description String?

  sectionId String @map("section_id")

  section Education @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Links {
  id           String  @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         LinkSubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model LinkSubsection {
  id String @id @default(uuid())

  label String?
  url   String?

  sectionId String @map("section_id")

  section Links @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Skills {
  id           String  @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  isShowLevel  Boolean @default(true)
  data         SkillSubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model SkillSubsection {
  id String @id @default(uuid())

  title String?
  level SkillLevel? @default(expert)

  sectionId String @map("section_id")

  section Skills @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Languages {
  id           String     @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         LanguageSubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model LanguageSubsection {
  id String @id @default(uuid())

  title String?
  level LanguageLevel?

  sectionId String @map("section_id")

  section Languages @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Courses {
  id           String   @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         CourseSubsection[]

  resumeId String @unique @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model CourseSubsection {
  id String @id @default(uuid())

  title       String?
  institution String?
  startDate   String? @map("start_date")
  endDate     String? @map("end_date")

  sectionId String @map("section_id")

  section Courses @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model CustomSections {
  id           String       @id @default(uuid())
  title        String?
  defaultTitle String?
  order        Int
  data         CustomSubsection[]

  resumeId String @map("resume_id")

  resume Resume @relation(fields: [resumeId], references: [id], onDelete: Cascade)
}
model CustomSubsection {
  id String @id @default(uuid())
  
  title       String?
  city        String?
  startDate   String? @map("start_date")
  endDate     String? @map("end_date")
  description String?

  sectionId String @map("section_id")

  section CustomSections @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

enum SkillLevel {
  novice
  beginner
  skillful
  experienced
  expert
}
enum LanguageLevel {
  nativeSpeaker
  highlyProficient
  goodWorkingKnowledge
  workingKnowledge
  A1
  A2
  B1
  B2
  C1
  C2
}
